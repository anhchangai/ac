#define _CRT_SECURE_NO_WARNINGS
#include <iostream>

using namespace std ; 
#define MAX 100000000
int n ; 
int d[101] ; 
int A[101][101] ; 
int visited[101] = {0} ; 
int sum = 0 ; 

int extractMin()
{
	int min = MAX ;
	int indexMin; 
	for(int i = 0 ; i < n; i++)
	{
		if(min >= d[i] && visited[i] == 0) 
		{
			min = d[i] ; 
			indexMin = i ; 
		}
	}
	return indexMin ; 
}

int main()
{
	freopen("input.txt" , "r" , stdin) ; 
	int T ; 
	cin >> T ;
	for(int tc = 1 ; tc <= T ; tc ++)
	{
		cin >> n ; 
		for(int i = 0 ; i < n; i++)
		{
			for(int j = 0 ; j < n ; j++)
			{
				cin >> A[i][j] ; 
			}
		}
		for(int i = 0 ; i < n; i++)
		{
			d[i] = MAX ; 
		}
		for(int i = 0 ; i < n; i++)
		{
			visited[i] = 0 ; 
		}
		d[0] = 0 ; 
		sum = 0 ;
		int m = n ; 
		int index ; 
		while(m-1>0)
		{
			index = extractMin() ; 
			visited[index] = 1 ;  

			for(int j = 0 ; j < n ; j++)
			{
				if( visited[j] == 0 && j!=index)
				{
			
						if(A[index][j] < d[j])
						{
							d[j] = A[index][j] ; 
						}
					
				}
			}
			m--; 
		}

		for(int i = 0 ; i < n ; i++)
		{
			sum += d[i] ; 
		}
		cout << "Case #" << tc << endl ; 
		cout << sum << endl ; 
	}
	return 0 ; 
}
